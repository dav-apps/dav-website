<div class="container navbar-margin pt-4 ms-motion-slideUpIn">
	<div class="d-flex mb-3">
		<div class="mx-auto d-flex">
			<button
				type="button"
				class="btn"
				style="height: 35px; width: 41px; padding: 2px 0px 0px 0px; margin-top: 7px"
				(click)="GoBack()">
				<fab-icon iconName="Back" [styles]="backButtonIconStyles"></fab-icon>
			</button>
			<h1 class="text-left ml-3 font-weight-light">{{ app.Name }}</h1>
		</div>
	</div>

	<div>
		<p class="mb-3 font-weight-light" style="font-size: 18px">{{ app.Description }}</p>

		<fluent-button
			appearance="accent"
			(click)="ShowAppStatistics()">
			{{ locale.statistics }}
		</fluent-button>

		<fluent-button
			style="margin-left: 10px"
			(click)="ShowEditAppDialog()">
			{{ locale.edit }}
		</fluent-button>

		<h5 class="font-weight-light mt-4">{{ locale.published }}</h5>
		<fab-toggle [checked]="app.Published" (onChange)="ShowPublishAppDialog()"></fab-toggle>
	</div>

	<div class="row">
		<div class="mx-4">
			<h3 class="font-weight-light mb-3 mt-4">{{ locale.tables }}</h3>
			<ul class="list-group">
				<li class="list-group-item text-center cursor font-weight-light p-1" style="font-size: 26px" (click)="ShowAddTableDialog()">+</li>
				<li class="list-group-item text-center" *ngFor="let table of app.Tables">{{ table.Name }}</li>
			</ul>
		</div>

		<div class="mx-4">
			<h3 class="font-weight-light mb-3 mt-4">{{ locale.apis }}</h3>
			<ul class="list-group">
				<li class="list-group-item text-center cursor font-weight-light p-1" style="font-size: 26px" (click)="ShowAddApiDialog()">+</li>
				<a [routerLink]="'api/' + api.Id" class="list-group-item list-group-item-action" *ngFor="let api of app.Apis">{{ api.Name }}</a>
			</ul>
		</div>
	</div>
</div>

<dav-website-dialog
	[title]="locale.editAppDialog.title"
	[primaryButtonText]="locale.save"
	[defaultButtonText]="locale.cancel"
	[isLoading]="editAppDialogLoading"
	(dismiss)="editAppDialogVisible = false"
	(defaultButtonClick)="editAppDialogVisible = false"
	(primaryButtonClick)="UpdateApp()"
	*ngIf="editAppDialogVisible">

	<!-- Name -->
	<div class="mb-3">
		<fluent-text-field
			style="width: 100%"
			[value]="newName"
			type="text"
			[placeholder]="locale.editAppDialog.nameTextfieldPlaceholder"
			(input)="newName = $event.target.value">
			{{ locale.editAppDialog.nameTextfieldLabel }}
		</fluent-text-field>

		<p class="text-field-error" *ngIf="editAppDialogNameError.length > 0">
			{{ editAppDialogNameError }}
		</p>
	</div>

	<!-- Description -->
	<div class="mb-3">
		<fluent-text-area
			style="width: 100%"
			[value]="newDescription"
			type="text"
			multiline="true"
			[placeholder]="locale.editAppDialog.descriptionTextfieldPlaceholder"
			(input)="newDescription = $event.target.value">
			{{ locale.editAppDialog.descriptionTextfieldLabel }}
		</fluent-text-area>

		<p class="text-field-error" *ngIf="editAppDialogDescriptionError.length > 0">
			{{ editAppDialogDescriptionError }}
		</p>
	</div>

	<!-- Weblink -->
	<div class="mb-3">
		<fluent-text-field
			style="width: 100%"
			[value]="newWebLink"
			type="text"
			[placeholder]="locale.editAppDialog.webLinkTextfieldPlaceholder"
			(input)="newWebLink = $event.target.value">
			{{ locale.editAppDialog.webLinkTextfieldLabel }}
		</fluent-text-field>

		<p class="text-field-error" *ngIf="editAppDialogWebLinkError.length > 0">
			{{ editAppDialogWebLinkError }}
		</p>
	</div>

	<!-- GooglePlayLink -->
	<div class="mb-3">
		<fluent-text-field
			style="width: 100%"
			[value]="newGooglePlayLink"
			type="text"
			[placeholder]="locale.editAppDialog.googlePlayLinkTextfieldPlaceholder"
			(input)="newGooglePlayLink = $event.target.value">
			{{ locale.editAppDialog.googlePlayLinkTextfieldLabel }}
		</fluent-text-field>

		<p class="text-field-error" *ngIf="editAppDialogGooglePlayLinkError.length > 0">
			{{ editAppDialogGooglePlayLinkError }}
		</p>
	</div>

	<!-- MicrosoftStoreLink -->
	<div class="mb-3">
		<fluent-text-field
			style="width: 100%"
			[value]="newMicrosoftStoreLink"
			type="text"
			[placeholder]="locale.editAppDialog.microsoftStoreLinkTextfieldPlaceholder"
			(input)="newMicrosoftStoreLink = $event.target.value">
			{{ locale.editAppDialog.microsoftStoreLinkTextfieldLabel }}
		</fluent-text-field>

		<p class="text-field-error" *ngIf="editAppDialogMicrosoftStoreLinkError.length > 0">
			{{ editAppDialogMicrosoftStoreLinkError }}
		</p>
	</div>
</dav-website-dialog>

<fab-dialog
	[hidden]="!publishAppDialogVisible"
	[dialogContentProps]="publishAppDialogContent"
	(onDismiss)="publishAppDialogVisible = false">
	<fab-dialog-footer>
		<fab-default-button (click)="publishAppDialogVisible = false">{{ locale.cancel }}</fab-default-button>
		<fab-primary-button [styles]="dialogPrimaryButtonStyles" (click)="PublishApp()">{{ locale.publishAppDialog.confirm }}</fab-primary-button>
	</fab-dialog-footer>
</fab-dialog>

<fab-dialog
	[hidden]="!addTableDialogVisible"
	[dialogContentProps]="addTableDialogContent"
	(onDismiss)="addTableDialogVisible = false">
	
	<div class="mb-4">
		<fab-text-field
			[(value)]="addTableDialogNewTableName"
			[label]="locale.addTableDialog.nameTextfieldLabel"
			[placeholder]="locale.addTableDialog.nameTextfieldPlaceholder"
			[errorMessage]="addTableDialogNewTableError"
			(keydown.enter)="AddTable()">
		</fab-text-field>
	</div>

	<fab-dialog-footer>
		<fab-default-button (click)="addTableDialogVisible = false">{{ locale.cancel }}</fab-default-button>
		<fab-primary-button [styles]="dialogPrimaryButtonStyles" (click)="AddTable()">{{ locale.save }}</fab-primary-button>
	</fab-dialog-footer>
</fab-dialog>

<fab-dialog
	[hidden]="!addApiDialogVisible"
	[dialogContentProps]="addApiDialogContent"
	(onDismiss)="addApiDialogVisible = false">

	<div class="mb-4">
		<fab-text-field
			[(value)]="addApiDialogApiName"
			[label]="locale.addApiDialog.nameTextfieldLabel"
			[placeholder]="locale.addApiDialog.nameTextfieldPlaceholder"
			[errorMessage]="addApiDialogApiNameError"
			(keydown.enter)="AddApi()">
		</fab-text-field>
	</div>

	<fab-dialog-footer>
		<fab-default-button (click)="addApiDialogVisible = false">{{ locale.cancel }}</fab-default-button>
		<fab-primary-button [styles]="dialogPrimaryButtonStyles" (click)="AddApi()">{{ locale.save }}</fab-primary-button>
	</fab-dialog-footer>
</fab-dialog>